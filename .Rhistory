#Psychosomatic
temp.count = mydata[,c(58,16)]
temp.table = table(temp.count)
temp.chisq = cbind(chisq.test(temp.table)$statistic,chisq.test(temp.table)$p.value)
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#combine Germ and ToM
temp.table=table(mydata[,c(57,14)])+table(mydata[,c(56,12)])
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#combine 3 domains
temp.table=table(mydata[,c(57,14)])+table(mydata[,c(56,12)])+table(mydata[,c(58,16)])
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
median(mydata$Psych_ass_T)
#linear model for combining Germ and ToM
cdata <- melt(mydata,id=c("Germ","ToM"))
head(cdata)
head(mydata)
cdata <- mydata[,c(1,12,14)]
head(cdata)
melt(cdata,id="X")
head(cdata)
cdata<-melt(cdata,id="X")
head(cdata)
#linear model for combining Germ and ToM
cdata <- mydata[,c(1,12,14)]
cdata<-melt(cdata,id="X")
summary(lm(value~variable,data=cdata))
#linear model for combining Germ and ToM
cdata <- mydata[,c(1,12,14,16)]
cdata<-melt(cdata,id="X")
summary(lm(value~variable,data=cdata))
#linear model for combining Germ and ToM
cdata <- mydata[,c(1,12,14)]
cdata<-melt(cdata,id="X")
summary(lm(value~variable,data=cdata))
mydata$Combf = as.factor((mydata$ToM_ass_T+mydata$Germ_ass_T)>=median(mydata$ToM_ass_T+mydata$Germ_ass_T))
cdata <- mydata[,c(1,12,14,59)]
head(cdata)
cdata<-melt(cdata,id=c("X"))
cdata <- mydata[,c(1,12,14,59)]
cdata<-melt(cdata,id="X")
head(cdata)
unique(data[,1])
mydata[,1]
head(cdata)
dim(cdata)
54*2
162/54
cdata <- mydata[,c(1,12,14,59)]
cdata<-melt(cdata,id=c("X","Combf"))
head(cdata)
summary(lm(value~Combf+Error(X/variable),data=cdata))
summary(aov(value~Combf+Error(X/variable),data=cdata))
summary(aov(value~Combf*variable+Error(X/variable),data=cdata))
(aov(value~Combf*variable,data=cdata))
summary(lm(value~Combf*variable,data=cdata))
head(cdata)
summary(aov(value~Combf*variable+Error(X),data=cdata))
dim(cdata)
#linear model for combining Germ and ToM
cdata <- mydata[,c(1,12,14,56,57)]
cdata<-melt(cdata,id=c("X","ToMf"))
summary(aov(value~Combf*variable+Error(X),data=cdata))
#linear model for combining Germ and ToM
cdata <- mydata[,c(1,12,14,56,57)]
cdata<-melt(cdata,id=c("X","ToMf"))
summary(aov(value~ToMf*variable+Error(X),data=cdata))
#linear model for combining Germ and ToM
cdata <- mydata[,c(1,12,14,56)]
cdata<-melt(cdata,id=c("X","ToMf"))
summary(aov(value~ToMf*variable+Error(X),data=cdata))
colnames(mydata)[1]<- "SubID"
rm(list = ls(all = TRUE))
#load needed libraries
library(psych)
library(gdata)
library(data.table)
library(ggplot2)
mydata  = read.table(file = "/Users/jennywang/Google Drive/cocodev/IGUB/IGUB_long_data.csv", sep=",",header=TRUE, na.strings="")
mydata=subset(mydata,mydata$yesbias==0)
colnames(mydata)[1]<- "SubID"
###overall descriptives
mydata$ToM=as.numeric(mydata$ToM=='table')
mydata$Germ=as.numeric(mydata$Germ=='temp')
mydata$Psycho=as.numeric(mydata$Psycho=='phone(tummy)')
des_m = describeBy(mydata,group=NULL,na.rm=TRUE)
cor(mydata$ToM,mydata$ToM_ass_T)
cor(mydata$Germ,mydata$Germ_ass_T)
cor(mydata$Psycho,mydata$Psych_ass_T)
#SRCD analysis did median-split for ToM and Germ, and >1 for Psychosomatic
mydata$ToMf = as.factor(mydata$ToM_ass_T>=median(mydata$ToM_ass_T))
mydata$Germf = as.factor(mydata$Germ_ass_T>=median(mydata$Germ_ass_T))
mydata$Psychf = as.factor(mydata$Psych_ass_T>=2)
des_T = describeBy(mydata$ToM,group=mydata$ToMf,na.rm=TRUE,mat=TRUE)
des_G = describeBy(mydata$Germ,group=mydata$Germf,na.rm=TRUE,mat=TRUE)
des_P = describeBy(mydata$Psycho,group=mydata$Psychf,na.rm=TRUE,mat=TRUE)
des_all=rbind(des_T,des_G,des_P)
des_all$item=c("ToM","ToM","Germ","Germ","Psych","Psych")
levels(des_all$group1)[levels(des_all$group1)=="FALSE"]<-"Lower"
levels(des_all$group1)[levels(des_all$group1)=="TRUE"]<-"Higher"
ggplot(data=des_all,aes(x=item,y=mean,fill=group1))+
geom_bar(stat="identity",position=position_dodge())+
geom_errorbar(aes(ymin=mean-se,ymax=mean+se),width=.1,
position=position_dodge(.9))+
ylim(0,1)+
theme_bw()
#ToM
temp.count = mydata[,c(56,12)]
temp.table = table(temp.count)
temp.chisq = cbind(chisq.test(temp.table)$statistic,chisq.test(temp.table)$p.value)
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#Germ
temp.count = mydata[,c(57,14)]
temp.table = table(temp.count)
temp.chisq = cbind(chisq.test(temp.table)$statistic,chisq.test(temp.table)$p.value)
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#Psychosomatic
temp.count = mydata[,c(58,16)]
temp.table = table(temp.count)
temp.chisq = cbind(chisq.test(temp.table)$statistic,chisq.test(temp.table)$p.value)
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#combine Germ and ToM
temp.table=table(mydata[,c(57,14)])+table(mydata[,c(56,12)])
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#linear model for combining Germ and ToM
cdata <- mydata[,c(1,12,14,56)]
cdata<-melt(cdata,id=c("SubID","ToMf"))
summary(aov(value~ToMf*variable+Error(SubID),data=cdata))
#combine 3 domains
temp.table=table(mydata[,c(57,14)])+table(mydata[,c(56,12)])+table(mydata[,c(58,16)])
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
cdata <- mydata[,c(1,12,56)]
cdata
head(cdata)
summary(aov(ToM~ToMf,data=cdata))
cdata <- mydata[,c(1,14,57)]
head(cdata)
summary(aov(Germ~Germf,data=cdata))
32/49
29/59
mean(14/25,18/24)
14/25
18/24
mean(0.56,0.75)
0.56+0.75
1.31/2
?binom.test
prop.test(c(12,32),c(16,48))
binom.test(12,16,p=0.5)
12/16
17/38
#Psychosomatic
temp.count = mydata[,c(58,16)]
temp.table = table(temp.count)
temp.chisq = cbind(chisq.test(temp.table)$statistic,chisq.test(temp.table)$p.value)
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
temp.chisq
#linear model for combining Germ and ToM
cdata <- mydata[,c(1,12,56)]
summary(aov(ToM~ToMf,data=cdata))
cdata <- mydata[,c(1,14,57)]
summary(aov(Germ~Germf,data=cdata))
#cdata<-melt(cdata,id=c("SubID","ToMf"))
#summary(aov(value~ToMf*variable+Error(SubID),data=cdata))
#combine 3 domains
temp.table=table(mydata[,c(57,14)])+table(mydata[,c(56,12)])+table(mydata[,c(58,16)])
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
rm(list = ls(all = TRUE))
#load needed libraries
library(psych)
library(gdata)
library(data.table)
library(ggplot2)
mydata  = read.table(file = "/Users/jennywang/Google Drive/cocodev/IGUB/IGUB_long_data.csv", sep=",",header=TRUE, na.strings="")
mydata=subset(mydata,mydata$yesbias==0)
colnames(mydata)[1]<- "SubID"
###overall descriptives
mydata$ToM=as.numeric(mydata$ToM=='table')
mydata$Germ=as.numeric(mydata$Germ=='temp')
mydata$Psycho=as.numeric(mydata$Psycho=='phone(tummy)')
des_m = describeBy(mydata,group=NULL,na.rm=TRUE)
cor(mydata$ToM,mydata$ToM_ass_T)
cor(mydata$Germ,mydata$Germ_ass_T)
cor(mydata$Psycho,mydata$Psych_ass_T)
#SRCD analysis did median-split for ToM and Germ, and >1 for Psychosomatic
mydata$ToMf = as.factor(mydata$ToM_ass_T>=median(mydata$ToM_ass_T))
mydata$Germf = as.factor(mydata$Germ_ass_T>=median(mydata$Germ_ass_T))
mydata$Psychf = as.factor(mydata$Psych_ass_T>=median(mydata$Psych_ass_T))
des_T = describeBy(mydata$ToM,group=mydata$ToMf,na.rm=TRUE,mat=TRUE)
des_G = describeBy(mydata$Germ,group=mydata$Germf,na.rm=TRUE,mat=TRUE)
des_P = describeBy(mydata$Psycho,group=mydata$Psychf,na.rm=TRUE,mat=TRUE)
des_all=rbind(des_T,des_G,des_P)
des_all$item=c("ToM","ToM","Germ","Germ","Psych","Psych")
levels(des_all$group1)[levels(des_all$group1)=="FALSE"]<-"Lower"
levels(des_all$group1)[levels(des_all$group1)=="TRUE"]<-"Higher"
ggplot(data=des_all,aes(x=item,y=mean,fill=group1))+
geom_bar(stat="identity",position=position_dodge())+
geom_errorbar(aes(ymin=mean-se,ymax=mean+se),width=.1,
position=position_dodge(.9))+
ylim(0,1)+
theme_bw()
#ToM
temp.count = mydata[,c(56,12)]
temp.table = table(temp.count)
temp.chisq = cbind(chisq.test(temp.table)$statistic,chisq.test(temp.table)$p.value)
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#Germ
temp.count = mydata[,c(57,14)]
temp.table = table(temp.count)
temp.chisq = cbind(chisq.test(temp.table)$statistic,chisq.test(temp.table)$p.value)
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#Psychosomatic
temp.count = mydata[,c(58,16)]
temp.table = table(temp.count)
temp.chisq = cbind(chisq.test(temp.table)$statistic,chisq.test(temp.table)$p.value)
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#combine Germ and ToM
temp.table=table(mydata[,c(57,14)])+table(mydata[,c(56,12)])
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#linear model for combining Germ and ToM
cdata <- mydata[,c(1,12,56)]
summary(aov(ToM~ToMf,data=cdata))
cdata <- mydata[,c(1,14,57)]
summary(aov(Germ~Germf,data=cdata))
#cdata<-melt(cdata,id=c("SubID","ToMf"))
#summary(aov(value~ToMf*variable+Error(SubID),data=cdata))
#combine 3 domains
temp.table=table(mydata[,c(57,14)])+table(mydata[,c(56,12)])+table(mydata[,c(58,16)])
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
rm(list = ls(all = TRUE))
#load needed libraries
library(psych)
library(gdata)
library(data.table)
library(ggplot2)
mydata  = read.table(file = "/Users/jennywang/Google Drive/cocodev/IGUB/IGUB_long_data.csv", sep=",",header=TRUE, na.strings="")
mydata=subset(mydata,mydata$yesbias==0)
colnames(mydata)[1]<- "SubID"
###overall descriptives
mydata$ToM=as.numeric(mydata$ToM=='table')
mydata$Germ=as.numeric(mydata$Germ=='temp')
mydata$Psycho=as.numeric(mydata$Psycho=='phone(tummy)')
des_m = describeBy(mydata,group=NULL,na.rm=TRUE)
cor(mydata$ToM,mydata$ToM_ass_T)
cor(mydata$Germ,mydata$Germ_ass_T)
cor(mydata$Psycho,mydata$Psych_ass_T)
#SRCD analysis did median-split for ToM and Germ, and >1 for Psychosomatic
mydata$ToMf = as.factor(mydata$ToM_ass_T>=median(mydata$ToM_ass_T))
mydata$Germf = as.factor(mydata$Germ_ass_T>=median(mydata$Germ_ass_T))
mydata$Psychf = as.factor(mydata$Psych_ass_T>=median(mydata$Psych_ass_T))
mydata$ToMf = as.factor(mydata$ToM_ass_T>=2)
mydata$Germf = as.factor(mydata$Germ_ass_T>=2)
mydata$Psychf = as.factor(mydata$Psych_ass_T>=2)
des_T = describeBy(mydata$ToM,group=mydata$ToMf,na.rm=TRUE,mat=TRUE)
des_G = describeBy(mydata$Germ,group=mydata$Germf,na.rm=TRUE,mat=TRUE)
des_P = describeBy(mydata$Psycho,group=mydata$Psychf,na.rm=TRUE,mat=TRUE)
des_all=rbind(des_T,des_G,des_P)
des_all$item=c("ToM","ToM","Germ","Germ","Psych","Psych")
levels(des_all$group1)[levels(des_all$group1)=="FALSE"]<-"Lower"
levels(des_all$group1)[levels(des_all$group1)=="TRUE"]<-"Higher"
ggplot(data=des_all,aes(x=item,y=mean,fill=group1))+
geom_bar(stat="identity",position=position_dodge())+
geom_errorbar(aes(ymin=mean-se,ymax=mean+se),width=.1,
position=position_dodge(.9))+
ylim(0,1)+
theme_bw()
#ToM
temp.count = mydata[,c(56,12)]
temp.table = table(temp.count)
temp.chisq = cbind(chisq.test(temp.table)$statistic,chisq.test(temp.table)$p.value)
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#Germ
temp.count = mydata[,c(57,14)]
temp.table = table(temp.count)
temp.chisq = cbind(chisq.test(temp.table)$statistic,chisq.test(temp.table)$p.value)
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#Psychosomatic
temp.count = mydata[,c(58,16)]
temp.table = table(temp.count)
temp.chisq = cbind(chisq.test(temp.table)$statistic,chisq.test(temp.table)$p.value)
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#combine Germ and ToM
temp.table=table(mydata[,c(57,14)])+table(mydata[,c(56,12)])
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#linear model for combining Germ and ToM
cdata <- mydata[,c(1,12,56)]
summary(aov(ToM~ToMf,data=cdata))
cdata <- mydata[,c(1,14,57)]
summary(aov(Germ~Germf,data=cdata))
#cdata<-melt(cdata,id=c("SubID","ToMf"))
#summary(aov(value~ToMf*variable+Error(SubID),data=cdata))
#combine 3 domains
temp.table=table(mydata[,c(57,14)])+table(mydata[,c(56,12)])+table(mydata[,c(58,16)])
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#SRCD analysis did median-split for ToM and Germ, and >1 for Psychosomatic
mydata$ToMf = as.factor(mydata$ToM_ass_T>=median(mydata$ToM_ass_T))
mydata$Germf = as.factor(mydata$Germ_ass_T>=median(mydata$Germ_ass_T))
mydata$Psychf = as.factor(mydata$Psych_ass_T>=median(mydata$Psych_ass_T))
mydata$ToMf = as.factor(mydata$ToM_ass_T>=2)
mydata$Germf = as.factor(mydata$Germ_ass_T>=2)
mydata$Psychf = as.factor(mydata$Psych_ass_T>=2)
rm(list = ls(all = TRUE))
#load needed libraries
library(psych)
library(gdata)
library(data.table)
library(ggplot2)
mydata  = read.table(file = "/Users/jennywang/Google Drive/cocodev/IGUB/IGUB_long_data.csv", sep=",",header=TRUE, na.strings="")
mydata=subset(mydata,mydata$yesbias==0)
colnames(mydata)[1]<- "SubID"
###overall descriptives
mydata$ToM=as.numeric(mydata$ToM=='table')
mydata$Germ=as.numeric(mydata$Germ=='temp')
mydata$Psycho=as.numeric(mydata$Psycho=='phone(tummy)')
des_m = describeBy(mydata,group=NULL,na.rm=TRUE)
cor(mydata$ToM,mydata$ToM_ass_T)
cor(mydata$Germ,mydata$Germ_ass_T)
cor(mydata$Psycho,mydata$Psych_ass_T)
#SRCD analysis did median-split for ToM and Germ, and >1 for Psychosomatic
mydata$ToMf = as.factor(mydata$ToM_ass_T>=median(mydata$ToM_ass_T))
mydata$Germf = as.factor(mydata$Germ_ass_T>=median(mydata$Germ_ass_T))
# mydata$Psychf = as.factor(mydata$Psych_ass_T>=median(mydata$Psych_ass_T))
#
# mydata$ToMf = as.factor(mydata$ToM_ass_T>=2)
# mydata$Germf = as.factor(mydata$Germ_ass_T>=2)
mydata$Psychf = as.factor(mydata$Psych_ass_T>=2)
des_T = describeBy(mydata$ToM,group=mydata$ToMf,na.rm=TRUE,mat=TRUE)
des_G = describeBy(mydata$Germ,group=mydata$Germf,na.rm=TRUE,mat=TRUE)
des_P = describeBy(mydata$Psycho,group=mydata$Psychf,na.rm=TRUE,mat=TRUE)
des_all=rbind(des_T,des_G,des_P)
des_all$item=c("ToM","ToM","Germ","Germ","Psych","Psych")
levels(des_all$group1)[levels(des_all$group1)=="FALSE"]<-"Lower"
levels(des_all$group1)[levels(des_all$group1)=="TRUE"]<-"Higher"
ggplot(data=des_all,aes(x=item,y=mean,fill=group1))+
geom_bar(stat="identity",position=position_dodge())+
geom_errorbar(aes(ymin=mean-se,ymax=mean+se),width=.1,
position=position_dodge(.9))+
ylim(0,1)+
theme_bw()
#ToM
temp.count = mydata[,c(56,12)]
temp.table = table(temp.count)
temp.chisq = cbind(chisq.test(temp.table)$statistic,chisq.test(temp.table)$p.value)
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#Germ
temp.count = mydata[,c(57,14)]
temp.table = table(temp.count)
temp.chisq = cbind(chisq.test(temp.table)$statistic,chisq.test(temp.table)$p.value)
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#Psychosomatic
temp.count = mydata[,c(58,16)]
temp.table = table(temp.count)
temp.chisq = cbind(chisq.test(temp.table)$statistic,chisq.test(temp.table)$p.value)
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#combine Germ and ToM
temp.table=table(mydata[,c(57,14)])+table(mydata[,c(56,12)])
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#linear model for combining Germ and ToM
cdata <- mydata[,c(1,12,56)]
summary(aov(ToM~ToMf,data=cdata))
cdata <- mydata[,c(1,14,57)]
summary(aov(Germ~Germf,data=cdata))
#cdata<-melt(cdata,id=c("SubID","ToMf"))
#summary(aov(value~ToMf*variable+Error(SubID),data=cdata))
#combine 3 domains
temp.table=table(mydata[,c(57,14)])+table(mydata[,c(56,12)])+table(mydata[,c(58,16)])
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
?chisq.test
head(mydata)
mydata$Agef = as.factor(mydata$Age>=median(mydata$Age))
dim(mydata)
#combine 3 domains analyze effect of age
temp.table=table(mydata[,c(59,14)])+table(mydata[,c(59,12)])+table(mydata[,c(59,16)])
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#ToM
temp.count = mydata[,c("ToM","ToMf")]
temp.table = table(temp.count)
temp.chisq = cbind(chisq.test(temp.table)$statistic,chisq.test(temp.table)$p.value)
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#Germ
temp.count = mydata[,c("Germ","Germf")]
temp.table = table(temp.count)
temp.chisq = cbind(chisq.test(temp.table)$statistic,chisq.test(temp.table)$p.value)
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#Psychosomatic
temp.count = mydata[,c("Psycho","Psychf")]
temp.table = table(temp.count)
temp.chisq = cbind(chisq.test(temp.table)$statistic,chisq.test(temp.table)$p.value)
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#combine Germ and ToM
temp.table=table(mydata[,c("Germ","Germf")])+table(mydata[,c("ToM","ToMf")])
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#combine 3 domains
temp.table=table(mydata[,c("ToM","ToMf")])+table(mydata[,c("Germ","Germf")])+table(mydata[,c("Psycho","Psychf")])
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#linear model for combining Germ and ToM
cdata <- mydata[,c("SubID","ToM","ToMf")]
summary(aov(ToM~ToMf,data=cdata))
cdata <- mydata[,c("SubID","Germ","Germf")]
summary(aov(Germ~Germf,data=cdata))
#cdata<-melt(cdata,id=c("SubID","ToMf"))
#summary(aov(value~ToMf*variable+Error(SubID),data=cdata))
#combine 3 domains analyze effect of age
temp.table=table(mydata[,c("ToM","Agef")])+table(mydata[,c("Germ","Agef")])+table(mydata[,c("Psycho","Agef")])
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
rm(list = ls(all = TRUE))
#load needed libraries
library(psych)
library(gdata)
library(data.table)
library(ggplot2)
mydata  = read.table(file = "/Users/jennywang/Google Drive/cocodev/IGUB/IGUB_long_data.csv", sep=",",header=TRUE, na.strings="")
mydata=subset(mydata,mydata$yesbias==0)
colnames(mydata)[1]<- "SubID"
###overall descriptives
mydata$ToM=as.numeric(mydata$ToM=='table')
mydata$Germ=as.numeric(mydata$Germ=='temp')
mydata$Psycho=as.numeric(mydata$Psycho=='phone(tummy)')
des_m = describeBy(mydata,group=NULL,na.rm=TRUE)
cor(mydata$ToM,mydata$ToM_ass_T)
cor(mydata$Germ,mydata$Germ_ass_T)
cor(mydata$Psycho,mydata$Psych_ass_T)
#SRCD analysis did median-split for ToM and Germ, and >1 for Psychosomatic
mydata$ToMf = as.factor(mydata$ToM_ass_T>=median(mydata$ToM_ass_T))
mydata$Germf = as.factor(mydata$Germ_ass_T>=median(mydata$Germ_ass_T))
# mydata$Psychf = as.factor(mydata$Psych_ass_T>=median(mydata$Psych_ass_T))
#
# mydata$ToMf = as.factor(mydata$ToM_ass_T>=2)
# mydata$Germf = as.factor(mydata$Germ_ass_T>=2)
mydata$Psychf = as.factor(mydata$Psych_ass_T>=2)
mydata$Agef = as.factor(mydata$Age>=median(mydata$Age))
des_T = describeBy(mydata$ToM,group=mydata$ToMf,na.rm=TRUE,mat=TRUE)
des_G = describeBy(mydata$Germ,group=mydata$Germf,na.rm=TRUE,mat=TRUE)
des_P = describeBy(mydata$Psycho,group=mydata$Psychf,na.rm=TRUE,mat=TRUE)
des_all=rbind(des_T,des_G,des_P)
des_all$item=c("ToM","ToM","Germ","Germ","Psych","Psych")
levels(des_all$group1)[levels(des_all$group1)=="FALSE"]<-"Lower"
levels(des_all$group1)[levels(des_all$group1)=="TRUE"]<-"Higher"
ggplot(data=des_all,aes(x=item,y=mean,fill=group1))+
geom_bar(stat="identity",position=position_dodge())+
geom_errorbar(aes(ymin=mean-se,ymax=mean+se),width=.1,
position=position_dodge(.9))+
ylim(0,1)+
theme_bw()
#ToM
temp.count = mydata[,c("ToM","ToMf")]
temp.table = table(temp.count)
temp.chisq = cbind(chisq.test(temp.table)$statistic,chisq.test(temp.table)$p.value)
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#Germ
temp.count = mydata[,c("Germ","Germf")]
temp.table = table(temp.count)
temp.chisq = cbind(chisq.test(temp.table)$statistic,chisq.test(temp.table)$p.value)
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#Psychosomatic
temp.count = mydata[,c("Psycho","Psychf")]
temp.table = table(temp.count)
temp.chisq = cbind(chisq.test(temp.table)$statistic,chisq.test(temp.table)$p.value)
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#combine Germ and ToM
temp.table=table(mydata[,c("Germ","Germf")])+table(mydata[,c("ToM","ToMf")])
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#linear model for combining Germ and ToM
cdata <- mydata[,c("SubID","ToM","ToMf")]
summary(aov(ToM~ToMf,data=cdata))
cdata <- mydata[,c("SubID","Germ","Germf")]
summary(aov(Germ~Germf,data=cdata))
#cdata<-melt(cdata,id=c("SubID","ToMf"))
#summary(aov(value~ToMf*variable+Error(SubID),data=cdata))
#combine 3 domains
temp.table=table(mydata[,c("ToM","ToMf")])+table(mydata[,c("Germ","Germf")])+table(mydata[,c("Psycho","Psychf")])
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
#combine 3 domains analyze effect of age
temp.table=table(mydata[,c("ToM","Agef")])+table(mydata[,c("Germ","Agef")])+table(mydata[,c("Psycho","Agef")])
temp.table
chisq.test(temp.table,simulate.p.value=TRUE,B=2000)
